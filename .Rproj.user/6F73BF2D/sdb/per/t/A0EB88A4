{
    "collab_server" : "",
    "contents" : "#' @import ggplot2\n\n#' @export\nplot_expense_trend <- function(category_to_plot, account_to_filter = 'Regular', bin_by = 'month', file = 'expenses_clean.rds', agg_type = 'sum') {\n\n  clean_data = readRDS(file)\n\n  plot_data = clean_data %>% filter(account == account_to_filter, category %in% category_to_plot) %>%\n    mutate_(.dots = setNames(\"lubridate::floor_date(date, bin_by)\", bin_by)) %>%\n    group_by_(bin_by) %>%\n    summarise_(.dots = setNames(\"aggregate_expenses(amount, agg_type)\", agg_type)) %>%\n    ungroup()\n\n  ggplot() + geom_bar(aes(x = plot_data[[bin_by]], y = plot_data[[agg_type]]), stat = 'identity', fill = 'steelblue')\n}\n\naggregate_expenses <- function(amount, agg_type) {\n\n  if(agg_type == 'sum') return(sum(amount))\n  if(agg_type == 'mean') return(mean(amount))\n  if(agg_type == 'count') return(length(amount))\n}\n\n",
    "created" : 1514701016632.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1752149293",
    "id" : "A0EB88A4",
    "lastKnownWriteTime" : 1514872566,
    "last_content_update" : 1515403896516,
    "path" : "~/monefystats/R/stats.R",
    "project_path" : "R/stats.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}